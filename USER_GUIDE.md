# ArcherDoc AI 用户使用手册

## 📖 目录
- [1. 产品简介](#1-产品简介)
- [2. 快速开始](#2-快速开始)
- [3. 系统设置](#3-系统设置)
- [4. PPT翻译](#4-ppt翻译)
- [5. 视频生成](#5-视频生成)
- [6. 文章生成](#6-文章生成)
- [7. AI配图](#7-ai配图)
- [8. 字体管理](#8-字体管理)
- [9. 常见问题](#9-常见问题)
- [10. 高级功能](#10-高级功能)

---

## 1. 产品简介

### 🎯 ArcherDoc AI 是什么？
ArcherDoc AI 是一款功能强大的企业级智能 PPT 处理工具，集**翻译、视频生成、文章创作、AI配图**于一体。它能够在保留 PowerPoint 原始格式、颜色、图像和布局的前提下，将文档翻译成指定语言，并可进一步生成：

- 🚀 **文本翻译** - 智能翻译，保持原始格式
- 🎬 **AI语音讲解视频** - 生成带解说的专业视频
- 📝 **多平台文章内容** - 一键生成各平台风格文章
- 🎨 **专业AI配图** - 为每页生成专业配图
- Aa **统一字体风格** - 一键统一文档字体

### 💡 适合谁使用？
- **企业培训部门** - 快速制作多语言培训材料
- **市场推广团队** - 生成产品介绍视频和宣传内容
- **内容创作者** - 将PPT转化为公众号文章和视频
- **国际业务人员** - 制作多语言演示文稿
- **教育培训机构** - 将课程PPT制作成在线视频

### 🌟 核心优势
- ✅ **格式完美保留** - 智能排版保护，防止文字溢出
- ✅ **多模型支持** - 支持本地和云端AI模型
- ✅ **隐私保护** - 支持完全离线处理
- ✅ **批量处理** - 高效处理大型文档
- ✅ **实时反馈** - Magic Text动态显示处理进度

---

## 2. 快速开始

### 2.1 安装和启动

#### 📱 桌面应用安装（推荐）
1. **下载应用**：
   - macOS：下载对应架构的DMG文件（Intel/Apple Silicon）
   - Windows：下载EXE安装包
   - Linux：下载AppImage文件

2. **安装应用**：
   - macOS：双击DMG文件，拖拽到Applications文件夹
   - Windows：双击EXE文件，按提示完成安装
   - Linux：添加执行权限后直接运行

3. **启动应用**：从开始菜单或应用程序文件夹启动ArcherDoc AI

#### 🌐 网页版使用
在浏览器中访问部署好的Web应用地址

### 2.2 上传文件
1. 启动应用后，在主界面找到文件上传区域
2. 将 `.pptx` 文件拖放到页面中央的虚线框区域
3. 或点击虚线框区域从电脑中选择文件
4. 系统会自动解析文件并显示幻灯片预览

### 2.3 选择功能
文件上传成功后，您可以看到五大核心功能按钮：

- 🚀 **文本翻译** - 将PPT翻译为指定语言
- 🎨 **AI配图** - 为PPT生成专业配图
- 📝 **文章撰写** - 将PPT转化为多平台文章
- 🎬 **视频配音** - 生成带AI语音讲解的视频
- Aa **字体统一** - 统一PPT字体风格

### 2.4 首次使用设置
首次使用时，点击右上角的 **设置 (⚙️)** 按钮进行基础配置：

1. **选择AI提供商**：
   - 新手推荐：Google Gemini（需要API密钥）
   - 隐私优先：Ollama本地模型（需要本地部署）
   - 高性价比：vLLM本地模型

2. **配置API密钥**（如使用云端服务）
3. **设置目标语言**（翻译功能）
4. **保存配置**，一次配置永久生效

### 2.5 快速上手流程
```
上传PPT → 选择功能 → 配置AI → 开始处理 → 下载结果
```

---

## 3. 系统设置

点击右上角的 **设置 (⚙️)** 按钮进入配置页面，包含以下设置模块：

### 3.1 AI设置
#### AI提供商选择
- **vLLM (本地)**：最佳隐私保护，需要本地部署
- **Ollama (本地)**：开源本地模型，支持完全离线
- **Google Gemini**：速度快且质量高，需要API Key
- **OpenRouter**：聚合平台，支持多种顶级模型

#### 模型配置
- **API密钥**：云端服务的访问密钥
- **模型名称**：选择具体使用的模型
- **服务地址**：本地模型的服务地址

### 3.2 翻译设置
- **目标语言**：选择翻译目标语言（英语、日语、韩语等）
- **专有名词术语表**：
  1. 输入原文词汇（如："AI"）
  2. 输入目标译文（如："人工智能"）
  3. 点击 **+** 添加到术语表
  4. 系统会在翻译时强制使用这些术语

### 3.3 视频生成设置
#### 语音合成模型
- **MiniMax**：专业中文语音，音质自然流畅
- **Coqui TTS**：开源本地语音，保护隐私
- **Qwen TTS**：阿里云语音服务，支持多种音色

#### MiniMax配置
- **Group ID**：MiniMax服务的群组ID
- **Access Token**：访问令牌
- **语音音色**：选择合适的播音员音色
- **语速调节**：调整语音播放速度（0.5-2.0倍）

#### Coqui TTS配置
- **扬声器参考文件**：上传参考音频来克隆音色
- **GPU阈值**：设置使用GPU加速的最小显存要求

### 3.4 图片生成设置
#### ComfyUI设置（本地）
- **服务地址**：ComfyUI服务器地址
- **模型选择**：选择图像生成模型
- **生成参数**：步数、CFG值、采样器等

#### NanoBanana设置（Google Gemini）
- **API密钥**：Google AI API密钥
- **模型选择**：gemini-3-pro-image-preview等
- **图片质量**：标准质量或高清质量
- **宽高比**：10种选项（1:1、16:9、9:16等）

---

## 4. PPT翻译

### 4.1 开始翻译
1. 上传PPT文件并完成设置配置
2. 点击主界面的 **开始翻译 🚀** 按钮
3. 系统将开始逐页处理幻灯片

### 4.2 翻译过程监控
在翻译过程中，您可以观察到：
- **实时进度条**：显示当前处理进度
- **Magic Text动画**：实时显示正在翻译的文本内容
- **字符统计图表**：对比原文和译文的字符数量
- **处理状态**：显示当前幻灯片和处理状态

### 4.3 翻译完成
翻译完成后：
1. 界面显示绿色完成提示
2. 点击 **⬇️ 下载文件** 按钮保存翻译后的PPTX
3. 翻译后的文档保持了原始的格式、布局和样式

### 4.4 智能特性
- **自适应字号**：系统会自动调整字号以防止文字溢出
- **样式保护**：完美保留字体颜色、加粗、斜体等格式
- **术语一致性**：根据术语表确保专业术语翻译的一致性

---

## 5. 视频生成

### 5.1 开始生成
1. 上传PPT文件并完成视频相关设置
2. 点击主界面的 **生成视频 🎬** 按钮
3. 系统将分析PPT内容并生成讲解稿

### 5.2 视频审核页面
处理完成后，您将进入视频审核页面，包含以下功能区域：

#### 左侧：幻灯片导航
- 幻灯片缩略图列表
- 当前处理状态指示
- 快速跳转到指定幻灯片

#### 中间：内容预览
- **幻灯片预览**：显示当前幻灯片内容
- **讲稿编辑框**：查看和编辑AI生成的讲解稿
- **媒体切换**：在图片和视频之间切换显示

#### 右侧：生成控制
- **语音生成**按钮
- **视频生成**按钮
- **处理日志**显示

### 5.3 讲稿编辑与优化
1. **查看讲稿**：系统自动为每页幻灯片生成讲解稿
2. **编辑内容**：在讲稿编辑框中修改文字内容
3. **智能优化**：
   - 保持口语化表达
   - 控制每段长度在15-30秒
   - 添加自然的过渡语

### 5.4 语音生成
#### MiniMax语音生成
1. 点击 **生成语音 (MiniMax)** 按钮
2. 系统调用云端API生成高质量语音
3. 支持多种专业播音员音色

#### Coqui TTS语音生成
1. 点击 **生成语音 (Coqui TTS)** 按钮
2. 使用本地模型生成语音
3. 支持自定义音色克隆

#### Qwen TTS语音生成
1. 点击 **生成语音 (Qwen TTS)** 按钮
2. 使用阿里云语音服务生成高质量语音
3. 支持多种自然音色，包括：
   - **Ethan**：男声 - 专业稳重
   - **Chelsie**：女声 - 自然流畅
   - **Cherry**：女声 - 温柔甜美
   - **Serena**：女声 - 知性优雅
   - **Dylan**：男声 - 北京话
   - **Jada**：女声 - 吴语
   - **Sunny**：女声 - 四川话

#### Qwen TTS配置要求
- **API密钥**：需要配置阿里云Qwen TTS的访问密钥
- **模型选择**：可选择不同的语音模型
- **方言支持**：支持多种地方语言特色

#### 语音预览与调整
- 点击 **预览语音** 按钮试听生成的音频
- 调整语速和停顿设置
- 重新生成不满意的音频

### 5.5 语音合成模型对比

#### MiniMax（云端专业服务）
**优势**：
- 生成效果最佳，语音自然流畅
- 支持多种高质量专业播音员音色
- 生成速度快，稳定性高
- 支持情感化语音表达

**劣势**：
- 需要消耗token，存在使用成本
- 依赖网络连接
- 需要配置Group ID和Access Token

**适用场景**：
- 对语音质量要求极高的专业视频
- 企业宣传片、产品介绍等商业用途
- 愿意承担一定使用成本的用户

#### Coqui TTS（开源本地）
**优势**：
- 完全免费，不消耗任何token
- 本地模型，注重隐私保护
- 支持自定义扬声器声音克隆
- 可离线使用，不依赖网络

**劣势**：
- 生成的声音相对机械，不够自然
- 生成速度较慢
- 本地计算资源消耗较大
- 需要一定的技术配置

**适用场景**：
- 注重隐私保护的用户
- 预算有限的项目
- 需要自定义特定音色的场景
- 希望离线使用的环境

#### Qwen TTS（阿里云服务）
**优势**：
- 音质自然，接近真人播音
- 支持多种方言（北京话、吴语、四川话等）
- 音色选择丰富，男女声搭配合理
- 阿里云服务稳定可靠

**劣势**：
- 需要API密钥，存在使用成本
- 依赖阿里云服务
- 需要网络连接

**适用场景**：
- 需要方言特色的内容
- 对音色多样性有要求的用户
- 中小企业和个人创作者
- 需要稳定云服务的项目

### 5.6 视频生成
#### 单页视频生成
1. 确认讲稿和语音后，点击 **生成视频** 按钮
2. 系统将幻灯片和语音合成为视频
3. 生成完成后可预览效果

#### 视频预览
- 点击 **预览当前页面视频** 按钮
- 在预览区域查看生成的视频
- 支持播放、暂停、进度控制

### 5.7 完整视频生成
1. 完成所有幻灯片的审核和修改
2. 点击 **提合并生成视频** 按钮
3. 系统自动合并所有单页视频
4. 生成完整的MP4视频文件

### 5.8 导出下载
- **在线播放**：在页面中直接播放完整视频
- **下载视频**：保存MP4文件到本地
- **下载音频**：单独下载语音文件

---

## 6. 文章生成

### 6.1 开始生成
1. 上传PPT文件
2. 点击主界面的 **生成文章 📝** 按钮
3. 在弹出的设置对话框中配置文章参数

### 6.2 文章设置
#### 平台风格选择
- **微信公众号**：专业深度，适合长文阅读
- **小红书**：生活化，图文并茂，种草推荐
- **微博**：简洁有力，话题性强，易传播
- **知乎**：理性分析，专业解答，深度思考
- **抖音**：短视频脚本，节奏紧凑，吸引眼球
- **B站**：年轻化，互动性强，知识分享

#### 文章类型选择
- **综合文章**：平衡深度和可读性（1500-2000字）
- **摘要文章**：简洁明了，适合快速阅读（800-1200字）
- **详细文章**：深度分析，专业内容（2000-3000字）
- **营销文章**：突出卖点，产品推广（1000-1500字）

#### 自定义提示词
在提示词编辑器中可以：
- 修改默认的生成指令
- 添加特定的写作要求
- 指定目标读者群体

### 6.3 文章生成过程
系统将显示：
- **实时进度条**：生成进度百分比
- **Magic Text**：当前生成的内容片段
- **处理日志**：详细的操作记录

### 6.4 文章审核页面
#### 主要功能区
1. **文章标题编辑**：修改AI生成的标题
2. **文章内容显示**：Markdown格式的精美展示
3. **编辑工具栏**：重新生成、微调等操作
4. **下载区域**：导出不同格式

### 6.5 文章编辑功能
#### 重新生成全新文章
1. 点击 **重新生成全新文章** 按钮
2. 选择新的平台风格和文章类型
3. 编辑生成提示词
4. 点击 **重新生成文章**

#### 微调当前文章
1. 点击 **微调当前文章** 按钮
2. 在微调提示词中输入具体要求：
   - "语言更生动活泼"
   - "增加具体案例"
   - "加强结论部分"
   - "调整段落结构"
3. 点击 **微调文章** 按钮

#### 手动编辑
- 直接在标题和内容区域进行文字编辑
- 支持实时预览效果
- 可随时撤销更改

### 6.6 文章导出
- **下载TXT**：纯文本格式
- **复制到剪贴板**：方便粘贴到其他平台
- **Markdown格式**：保留格式信息
- **HTML格式**：适合网页发布

---

## 7. AI配图

### 7.1 开始生成
1. 上传PPT文件
2. 点击主界面的 **AI配图 🎨** 按钮
3. 系统将分析每页幻灯片内容

### 7.2 智能内容分析
系统自动为每页幻灯片生成：
- **内容描述**：AI分析页面主要内容
- **建议提示词**：优化后的图片生成提示词
- **关键词提取**：核心视觉元素

### 7.3 图片生成审核页面
#### 页面布局
- **左侧**：幻灯片导航和状态
- **中间**：幻灯片预览和生成控制
- **右侧**：参数设置和日志

#### 生成控制
1. **选择生成模型**：
   - **ComfyUI**：本地生成，速度较快
   - **NanoBanana**：云端Gemini生成，质量更高

2. **编辑提示词**：
   - 查看AI生成的建议提示词
   - 根据需要修改提示词内容
   - 添加特定的风格要求

3. **点击生成**：选择模型后开始生成

### 7.4 生成模型对比

#### ComfyUI（本地）
**优势**：
- 生成速度快
- 完全本地处理，保护隐私
- 无额外使用成本
- 支持多种模型切换

**劣势**：
- 需要本地GPU支持
- 图片质量依赖本地模型
- 配置相对复杂

**适用场景**：
- 需要快速生成大量图片
- 隐私要求高的场景
- 预算有限的项目

#### NanoBanana（Google Gemini）
**优势**：
- 图片质量高，效果稳定
- 支持多种宽高比
- 无需本地硬件要求
- 使用简单，配置方便

**劣势**：
- 需要消耗API配额
- 生成速度相对较慢
- 依赖网络连接

**适用场景**：
- 对图片质量要求高
- 需要特定宽高比
- 硬件配置有限

### 7.5 高级参数设置
#### 宽高比选项
支持10种常用宽高比：
- **正方形**：1:1（适合头像、图标）
- **横屏**：16:9、4:3、3:2（适合演示、背景）
- **竖屏**：9:16、3:4、2:3（适合手机、竖版内容）
- **超宽屏**：21:9（适合电影、宽幅背景）

#### 图片质量
- **标准质量**：1K分辨率，生成速度快
- **高清质量**：2K分辨率，效果更细腻

#### 风格控制
通过提示词可以控制：
- **艺术风格**：写实、卡通、水彩、油画等
- **内容类型**：人物、风景、建筑、科技等
- **色彩氛围**：明亮、暗调、温暖、冷色等

### 7.6 批量生成与管理
#### 批量操作
1. **逐页生成**：一页一页地生成和审核
2. **批量生成**：选择多页同时生成
3. **统一设置**：为所有页面应用相同参数

#### 质量审核
- 查看生成的图片效果
- 对比原幻灯片内容匹配度
- 重新生成不满意的图片
- 调整提示词优化效果

### 7.7 导出与应用
#### 图片下载
- 下载单个生成的图片
- 批量下载所有图片
- 选择不同分辨率和质量

#### 应用到PPT
- 自动替换原PPT中的图片
- 保存新的PPTX文件
- 保持原始布局和格式

---

## 8. 字体管理

### 8.1 统一字体功能
1. 上传PPT文件
2. 点击主界面的 **统一字体 Aa** 按钮
3. 在弹出的字体选择器中选择目标字体
4. 系统自动替换所有文本框的字体

### 8.2 字体选择器
#### 字体分类
- **常用字体**：思源黑体、微软雅黑、苹方等
- **宋体类**：思源宋体、方正宋体等
- **黑体类**：思源黑体、方正黑体等
- **艺术字体**：创意字体、手写体等

#### 字体预览
- 实时预览选中字体的效果
- 显示不同字号的样本
- 支持中英文混合预览

### 8.3 智能特性
- **记住选择**：系统记住用户上次选择的字体
- **字体推荐**：根据内容类型推荐合适字体
- **批量处理**：一次性处理所有幻灯片
- **格式保护**：保留原有的字号和颜色设置

---

## 9. 常见问题

### 9.1 连接问题

#### "Network Error" 或 "Failed to fetch"
**原因分析**：
- 本地AI服务未启动
- 网络连接问题
- API密钥配置错误

**解决方案**：
1. **检查本地服务**：
   - 确认Ollama/vLLM服务正在运行
   - 检查服务地址和端口是否正确
   - 验证跨域配置是否生效

2. **检查云端API**：
   - 验证API密钥是否正确
   - 检查网络连接状态
   - 确认API配额是否充足

### 9.2 排版问题

#### "文字溢出或版面错乱"
**原因分析**：
- 翻译后文本长度大幅增加
- 原始文本框空间有限
- 字体设置不当

**解决方案**：
1. **自动调整**：系统会自动缩小字号适应文本框
2. **手动优化**：在PowerPoint中进一步调整布局
3. **分段处理**：将长文本分为多个文本框

### 9.3 视频生成问题

#### "语音生成失败"
**解决方案**：
1. 检查MiniMax配置的Group ID和Access Token
2. 确认讲稿内容不为空
3. 尝试切换不同的语音合成模型
4. 检查网络连接状态

#### "视频合成失败"
**解决方案**：
1. 确认已成功生成语音文件
2. 检查幻灯片图片是否正常
3. 尝试重新生成语音
4. 联系技术支持

### 9.4 图片生成问题

#### "ComfyUI连接失败"
**解决方案**：
1. 检查ComfyUI服务是否运行
2. 验证服务地址是否正确
3. 确认模型是否已加载
4. 检查GPU资源是否充足

#### "NanoBanana API调用失败"
**解决方案**：
1. 验证Google AI API密钥
2. 检查网络连接
3. 确认API配额是否充足
4. 尝试更换提示词重新生成

### 9.5 性能问题

#### "处理速度慢"
**优化建议**：
1. **使用本地模型**：对于大量文档处理，本地模型通常更快
2. **减少并发**：避免同时处理多个大文件
3. **检查网络**：云端服务受网络速度影响
4. **硬件升级**：本地模型需要足够的GPU内存

---

## 10. 高级功能

### 10.1 本地模型配置

#### Ollama配置
```bash
# 启动Ollama服务
ollama serve

# 下载模型
ollama pull qwen2.5:7b
ollama pull llama3:8b

# 跨域配置
export OLLAMA_ORIGINS="*"
```

#### VLLM配置
```bash
# 启动VLLM服务
python -m vllm.entrypoints.openai.api_server \
  --model qwen2.5:7b \
  --host 0.0.0.0 \
  --port 8000 \
  --allowed-origins "*"
```

### 10.2 批量处理

#### 文档批量翻译
1. 准备多个PPT文件
2. 使用相同的设置配置
3. 依次处理每个文档
4. 系统保持术语一致性

#### 批量图片生成
1. 在AI配图页面选择多个幻灯片
2. 统一设置生成参数
3. 批量启动生成任务
4. 集中审核所有结果

### 10.3 自定义模板

#### 提示词模板
在 `utils/promptTemplates.ts` 中可以：
- 修改翻译提示词模板
- 自定义文章生成模板
- 优化图片生成提示词

#### 工作流配置
在 `AIStudio/n8n_workflows/` 中可以：
- 修改视频生成工作流
- 调整处理参数
- 添加新的处理节点

### 10.4 数据导出

#### 处理日志导出
- 导出详细的处理记录
- 分析处理效率
- 优化参数配置

#### 结果数据备份
- 备份生成的翻译结果
- 保存语音文件
- 归档生成的图片

---

## 11. 安装与获取

### 💻 系统要求
- **操作系统**：Windows 10+、macOS 10.15+、Linux (Ubuntu 20.04+)
- **内存**：建议8GB以上
- **存储空间**：至少2GB可用空间
- **网络**：如使用云端AI服务需要稳定的网络连接

### 📥 下载方式

#### 桌面应用（推荐）
1. **获取最新版本**：
   - 联系技术支持或访问项目发布页面
   - 选择对应您操作系统的版本

2. **版本信息**：
   - macOS Intel x64: `ArcherDoc AI-1.0.0.dmg` (129MB)
   - macOS Apple Silicon: `ArcherDoc AI-1.0.0-arm64.dmg` (125MB)
   - Windows 通用版: `ArcherDoc AI Setup 1.0.0.exe` (207MB)
   - Linux 通用版: `ArcherDoc AI-1.0.0.AppImage` (129MB)

#### 网页版
- 企业用户可选择内网部署版本
- 部署完成后通过浏览器访问

### 🔄 版本更新
- 桌面应用会自动检查更新
- 可通过设置菜单手动检查更新
- 建议及时更新到最新版本以获得最佳体验

---

## 12. 技术支持

### 🆘 遇到问题怎么办？

#### 常见问题快速排查
1. **无法启动**：检查系统权限和防病毒软件设置
2. **连接失败**：确认网络连接和API配置
3. **处理错误**：查看错误日志和解决方案
4. **性能问题**：检查硬件配置和资源使用

#### 获取帮助的方式

1. **用户手册**：首先查阅本文档的对应章节
2. **错误日志**：查看详细的错误信息和解决建议
3. **GitHub Issues**：提交技术问题和bug报告
4. **技术支持**：联系我们的专业技术团队

#### 提交问题时请包含
- **操作系统版本**：如Windows 11、macOS 14.0
- **应用版本**：如ArcherDoc AI v1.0.0
- **详细描述**：问题出现的具体步骤
- **错误信息**：完整的错误日志或截图
- **预期结果**：您期望实现的功能

### 💡 使用技巧
- **批量处理**：同时处理多个相似文件可提高效率
- **模板保存**：保存常用设置为模板
- **定期清理**：清理处理历史和临时文件
- **备份重要**：重要处理结果及时备份

我们会持续改进产品功能，为您提供更好的使用体验！

**ArcherDoc AI v1.0.0 用户手册**
*最后更新：2024年12月*